# if on a board
if [[ "$(whoami)" = "xavier"* ]] || [[ "$(whoami)" = "nvidia"* ]]
then
    # link the home venv
    expected_venv_path="/home/$(whoami)/.venv"
    if [ -d "$expected_venv_path" ]
    then
        rm -rf "$FORNIX_FOLDER/.venv"
        rm -f "$FORNIX_FOLDER/.venv"
        ln -s "$expected_venv_path" "$FORNIX_FOLDER/.venv"
    fi
fi


# TMPDIR fixes a pip issue
export TMPDIR="$FORNIX_HOME/tmp.cleanable"
mkdir -p "$TMPDIR"
export VIRTUAL_ENV="$FORNIX_FOLDER/.venv"
export PATH="$VIRTUAL_ENV/bin:$PATH"
if ! [ -d "$VIRTUAL_ENV" ]
then
    echo "creating virtual env for python"
    # run the cleanup
    . "$FORNIX_FOLDER/settings/extensions/python/during_clean.sh"
    python -m venv "$VIRTUAL_ENV" && echo "virtual env created"
fi

# fix SSL issues
export SSL_CERT_FILE="$(python -c 'import ssl; print(ssl.get_default_verify_paths().openssl_cafile)')"  